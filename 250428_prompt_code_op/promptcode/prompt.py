import anthropic
import os,json
from dotenv import load_dotenv
from content import system_prompt,prompt
from dataextract import extract_json_from_text
load_dotenv()

client = anthropic.Anthropic(
    api_key=os.environ.get("ANTHROPIC_API_KEY"),
)


def create_prompt(client,system_prompt,prompt):
    message = client.messages.create(
        model="claude-3-5-sonnet-20241022",
        max_tokens=8192,
        temperature=1,
        system=system_prompt,
        messages=[
            {
                "role": "user",
                "content": [
                    {
                        "type": "text",
                        "text": "<examples>\n<example>\n<var_material>\nAluminum\n</var_material>\n<extra_features>\nNumber of threaded faces: 0\nNo threaded faces found.\n</extra_features>\n<var_cutting_para>\n{\n  \"material\": \"Aluminum\",\n  \"cutting_parameters\": {\n    \"operations\": {\n      \"Milling\": {\n        \"End Mill\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 75.0,\n              \"max\": 105.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.05,\n              \"max\": 0.15\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Prevent chip welding\"\n          },\n          \"Carbide\": {\n            \"cutting_speed_range\": {\n              \"min\": 150.0,\n              \"max\": 600.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.075,\n              \"max\": 0.25\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"High speed capable\"\n          }\n        },\n        \"Face Mill\": {\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 300.0,\n              \"max\": 1000.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.4\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 6.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Polished rake face\"\n          }\n        }\n      },\n      \"Turning\": {\n        \"External\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 60.0,\n              \"max\": 90.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.35\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Sharp cutting edges\"\n          },\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 300.0,\n              \"max\": 800.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.2,\n              \"max\": 0.5\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 6.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"High polish tools\"\n          }\n        }\n      }\n    }\n  }\n}\n</var_cutting_para>\n<var_identified_faces>\nPart Analysis:\nVolume and Material Usage:\n- Part Volume: 6428406.34 cubic units\n- Total Surface Area: 286183.32 square units\n- Raw Material Block Size (with 2mm margin):\n  * Length: 204.00 units\n  * Width: 204.00 units\n  * Height: 204.00 units\n- Raw Material Volume: 8489664.02 cubic units\n- Material Removal Required: 2061257.69 cubic units\n- Material Utilization: 75.7%\n\nFeature Summary:\nTotal Faces: 15\nBasic Surfaces:\n- 14 planar faces\n- 1 cylindrical faces\n- 0 conical faces\n- 0 spherical faces\n- 0 toroidal faces\n\nAdvanced Surfaces:\n- 0 Bezier surfaces\n- 0 B-Spline surfaces\n- 0 other surface types\n- 0 unidentified surfaces\n\nDetailed Surface Analysis:\nSurface 1:\n  Type: Plane\n  Area: 281.43\nSurface 2:\n  Type: Plane\n  Area: 281.43\nSurface 3:\n  Type: Plane\n  Area: 281.43\nSurface 4:\n  Type: Plane\n  Area: 281.43\nSurface 5:\n  Type: Plane\n  Area: 39600.00\nSurface 6:\n  Type: Plane\n  Area: 39600.00\nSurface 7:\n  Type: Plane\n  Area: 31350.02\nSurface 8:\n  Type: Plane\n  Area: 281.43\nSurface 9:\n  Type: Plane\n  Area: 281.43\nSurface 10:\n  Type: Plane\n  Area: 281.43\nSurface 11:\n  Type: Plane\n  Area: 281.43\nSurface 12:\n  Type: Plane\n  Area: 39600.00\nSurface 13:\n  Type: Plane\n  Area: 31350.02\nSurface 14:\n  Type: Cylinder\n  Area: 62831.85\n  Radius: 50.00\nSurface 15:\n  Type: Plane\n  Area: 39600.00\n</var_identified_faces>\n<ideal_output>\n{\n  \"machining_analysis\": {\n    \"machining_process_selected\": \"Milling\",\n    \"setup_count\": 2,\n    \"tool_count\": 3,\n    \"operation_count\": 6,\n    \"machining_time\": 78.4min,\n    \"toolpath_length\": 68112mm,\n    \"process_details\": {\n      \"setup_1\": {\n        \"operations\": [\n          {\n            \"name\": \"Face Milling\",\n            \"tool\": \"Face Mill Φ100\",\n            \"length\": 1224mm,\n            \"machining_time\": 2.0\n          },\n          {\n            \"name\": \"Contour Milling\",\n            \"tool\": \"End Mill Φ20\",\n            \"length\": 80000mm,\n            \"machining_time\": 26.7 min\n          },\n          {\n            \"name\": \"Finish Cylinder\",\n            \"tool\": \"End Mill Φ16\",\n            \"length\": 62832 mm,\n            \"machining_time\": 10.5min\n          }\n        ],\n        \"total_toolpath_length\": 144056 mm,\n        \"total_machining_time\": 39.2 min\n      },\n      \"setup_2\": {\n        \"description\": \"Similar operations for opposite side\",\n        \"total_toolpath_length\": 144056 mm ,\n        \"total_machining_time\": 39.2 min\n      }\n    },\n    \"setup_times\": {\n      \"machine_setup\": 30,\n      \"tool_setup\": 15,\n      \"work_setup\": 20\n    }\n  },\n  \"justification\": {\n    \"machine_selection\": \"3-axis CNC mill selected due to prismatic part geometry\",\n    \"machine_size\": \"Medium-sized machine adequate for 204mm cube stock\",\n    \"tool_selection\": [\n      \"Face mill for bulk material removal\",\n      \"End mills for contour and cylinder features\"\n    ],\n    \"setup_considerations\": {\n      \"part_weight\": \"~17kg aluminum\",\n      \"reference_surfaces\": \"Multiple\",\n      \"alignment_requirements\": \"Standard\",\n      \"fixturing_needs\": \"Basic\"\n    },\n    \"toolpath_notes\": \"Contour milling results in longer toolpath and machining time compared to pocket milling due to multiple depth passes required, complete perimeter machining for each pass, and additional radial passes for stock removal\"\n  },\n  \"material_removal_volume\": 2061257.69,\n  \"calculations\": {\n    \"perimeter\": \"4 × 200 mm = 800 mm (approximate outer boundary)\",\n    \"radial_passes\": \"(Stock thickness - Final thickness)/radial depth of cut = (204-200)/2 = 2 passes\",\n    \"depth_passes\": \"Total depth/depth per pass = 200/4 = 50 passes\"\n  }\n}\n</ideal_output>\n</example>\n<example>\n<var_material>\nPure Tatinum\n</var_material>\n<extra_features>\nNumber of threaded faces: 0\nNo threaded faces found.\n</extra_features>\n<var_cutting_para>\n{\n  \"material\": \"Pure Titanium\",\n  \"cutting_parameters\": {\n    \"operations\": {\n      \"Milling\": {\n        \"End Mill\": {\n          \"Carbide\": {\n            \"cutting_speed_range\": {\n              \"min\": 30.0,\n              \"max\": 45.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.05,\n              \"max\": 0.1\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 0.5,\n              \"max\": 2.0\n            },\n            \"coolant_requirement\": \"Required\",\n            \"special_notes\": \"Sharp cutting edges\"\n          }\n        },\n        \"Face Mill\": {\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 40.0,\n              \"max\": 60.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.075,\n              \"max\": 0.15\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 0.5,\n              \"max\": 2.0\n            },\n            \"coolant_requirement\": \"Required\",\n            \"special_notes\": \"High pressure coolant\"\n          }\n        }\n      },\n      \"Turning\": {\n        \"External\": {\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 45.0,\n              \"max\": 70.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.1,\n              \"max\": 0.2\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 0.5,\n              \"max\": 2.0\n            },\n            \"coolant_requirement\": \"Required\",\n            \"special_notes\": \"Monitor tool wear\"\n          }\n        }\n      }\n    }\n  }\n}\n</var_cutting_para>\n<var_identified_faces>\nPart Analysis:\nVolume and Material Usage:\n- Part Volume: 6428406.34 cubic units\n- Total Surface Area: 286183.32 square units\n- Raw Material Block Size (with 2mm margin):\n  * Length: 204.00 units\n  * Width: 204.00 units\n  * Height: 204.00 units\n- Raw Material Volume: 8489664.02 cubic units\n- Material Removal Required: 2061257.69 cubic units\n- Material Utilization: 75.7%\n\nFeature Summary:\nTotal Faces: 15\nBasic Surfaces:\n- 14 planar faces\n- 1 cylindrical faces\n- 0 conical faces\n- 0 spherical faces\n- 0 toroidal faces\n\nAdvanced Surfaces:\n- 0 Bezier surfaces\n- 0 B-Spline surfaces\n- 0 other surface types\n- 0 unidentified surfaces\n\nDetailed Surface Analysis:\nSurface 1:\n  Type: Plane\n  Area: 281.43\nSurface 2:\n  Type: Plane\n  Area: 281.43\nSurface 3:\n  Type: Plane\n  Area: 281.43\nSurface 4:\n  Type: Plane\n  Area: 281.43\nSurface 5:\n  Type: Plane\n  Area: 39600.00\nSurface 6:\n  Type: Plane\n  Area: 39600.00\nSurface 7:\n  Type: Plane\n  Area: 31350.02\nSurface 8:\n  Type: Plane\n  Area: 281.43\nSurface 9:\n  Type: Plane\n  Area: 281.43\nSurface 10:\n  Type: Plane\n  Area: 281.43\nSurface 11:\n  Type: Plane\n  Area: 281.43\nSurface 12:\n  Type: Plane\n  Area: 39600.00\nSurface 13:\n  Type: Plane\n  Area: 31350.02\nSurface 14:\n  Type: Cylinder\n  Area: 62831.85\n  Radius: 50.00\nSurface 15:\n  Type: Plane\n  Area: 39600.00\n</var_identified_faces>\n<ideal_output>\n{\n  \"machining_analysis\": {\n    \"machining_process_selected\": \"Milling\",\n    \"setup_count\": 2,\n    \"tool_count\": 5,\n    \"operation_count\": 10,\n    \"machining_time\": 348.8 min,\n    \"toolpath_length\": 93100 mm,\n    \"part_data\": {\n      \"part_volume\": 6428406 mm3,\n      \"stock_volume\": 8489664 mm3,\n      \"material_to_remove\": 2061258 mm3,\n      \"material_removal_percentage\": 24.3%,\n      \"material\": \"Titanium\",\n      \"stock_size\": \"204 x 204 x 204 mm\",\n      \"key_features\": [\n        \"Large cubic block with central through hole\",\n        \"Hole diameter: Ø100mm (from cylindrical surface radius 50mm)\",\n        \"14 planar faces\",\n        \"1 cylindrical face\",\n        \"Large part size requiring heavy-duty machine\"\n      ]\n    },\n    \"process_details\": {\n      \"setup_1\": {\n        \"operations\": [\n          {\n            \"tool\": \"Face Mill (Ø125mm)\",\n            \"time\": 45.6,\n            \"toolpath\": 4200\n          },\n          {\n            \"tool\": \"End Mill (Ø32mm)\",\n            \"time\": 68.4,\n            \"toolpath\": 3600,\n            \"operation_type\": \"Roughing\"\n          },\n          {\n            \"tool\": \"End Mill (Ø25mm)\",\n            \"time\": 52.5,\n            \"toolpath\": 2800,\n            \"operation_type\": \"Semi-finishing\"\n          },\n          {\n            \"tool\": \"Ball Mill (Ø20mm)\",\n            \"time\": 35.8,\n            \"toolpath\": 2400\n          }\n        ],\n        \"total_time\": 202.3\n      },\n      \"setup_2\": {\n        \"operations\": [\n          {\n            \"tool\": \"Face Mill (Ø125mm)\",\n            \"time\": 45.6,\n            \"toolpath\": 4200\n          },\n          {\n            \"tool\": \"End Mill (Ø32mm)\",\n            \"time\": 58.5,\n            \"toolpath\": 3100\n          },\n          {\n            \"tool\": \"Various\",\n            \"time\": 42.4,\n            \"toolpath\": 2800,\n            \"operation_type\": \"Finishing operations\"\n          }\n        ],\n        \"total_time\": 146.5\n      }\n    },\n    \"setup_times\": {\n      \"machine_setup\": 45,\n      \"tool_setup\": 25,\n      \"work_setup\": 35\n    }\n  },\n  \"justification\": {\n    \"machine_selection\": [\n      \"Selected heavy-duty 3-axis CNC mill because:\",\n      \"Large part size (204mm cube)\",\n      \"High material volume (8.5M mm³)\",\n      \"Titanium material requires rigid setup\",\n      \"Simple geometry doesn't require 5-axis\",\n      \"Through hole can be machined from both sides\"\n    ],\n    \"cutting_parameters\": [\n      \"Reduced speeds (30-40% of aluminum rates)\",\n      \"Conservative feed rates\",\n      \"Multiple depth passes\",\n      \"Abundant coolant required\",\n      \"Rigid tooling and setup needed\"\n    ],\n    \"setup_considerations\": [\n      \"Heavy part weight (~37kg)\",\n      \"Lifting equipment needed\",\n      \"Multiple operator handling\",\n      \"Precise alignment requirements\",\n      \"In-process measurements\"\n    ],\n    \"material_notes\": \"The calculations consider titanium's difficult machinability, requiring slower speeds and more conservative cutting parameters compared to aluminum. Toolpath lengths and times are proportionally higher due to the material properties and volume of material removal required.\"\n  },\n  \"selected_machine\": \"CNC_3AXIS_HEAVY_DUTY\"\n</ideal_output>\n</example>\n<example>\n<var_material>\nAluminum\n</var_material>\n<extra_features>\nNumber of threaded faces: 0\nNo threaded faces found.\n</extra_features>\n<var_cutting_para>\n{\n  \"material\": \"Aluminum\",\n  \"cutting_parameters\": {\n    \"operations\": {\n      \"Milling\": {\n        \"End Mill\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 75.0,\n              \"max\": 105.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.05,\n              \"max\": 0.15\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Prevent chip welding\"\n          },\n          \"Carbide\": {\n            \"cutting_speed_range\": {\n              \"min\": 150.0,\n              \"max\": 600.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.075,\n              \"max\": 0.25\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"High speed capable\"\n          }\n        },\n        \"Face Mill\": {\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 300.0,\n              \"max\": 1000.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.4\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 6.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Polished rake face\"\n          }\n        }\n      },\n      \"Turning\": {\n        \"External\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 60.0,\n              \"max\": 90.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.35\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Sharp cutting edges\"\n          },\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 300.0,\n              \"max\": 800.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.2,\n              \"max\": 0.5\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 6.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"High polish tools\"\n          }\n        }\n      }\n    }\n  }\n}\n</var_cutting_para>\n<var_identified_faces>\nPart Analysis:\nVolume and Material Usage:\n- Part Volume: 803253.13 cubic units\n- Total Surface Area: 71309.03 square units\n- Raw Material Block Size (with 2mm margin):\n  * Length: 104.00 units\n  * Width: 104.00 units\n  * Height: 104.00 units\n- Raw Material Volume: 1124864.01 cubic units\n- Material Removal Required: 321610.88 cubic units\n- Material Utilization: 71.4%\n\nFeature Summary:\nTotal Faces: 15\nBasic Surfaces:\n- 14 planar faces\n- 1 cylindrical faces\n- 0 conical faces\n- 0 spherical faces\n- 0 toroidal faces\n\nAdvanced Surfaces:\n- 0 Bezier surfaces\n- 0 B-Spline surfaces\n- 0 other surface types\n- 0 unidentified surfaces\n\nDetailed Surface Analysis:\nSurface 1:\n  Type: Cylinder\n  Area: 15707.96\n  Radius: 25.00\nSurface 2:\n  Type: Plane\n  Area: 140.01\nSurface 3:\n  Type: Plane\n  Area: 140.01\nSurface 4:\n  Type: Plane\n  Area: 140.01\nSurface 5:\n  Type: Plane\n  Area: 140.01\nSurface 6:\n  Type: Plane\n  Area: 9800.00\nSurface 7:\n  Type: Plane\n  Area: 9800.00\nSurface 8:\n  Type: Plane\n  Area: 7640.50\nSurface 9:\n  Type: Plane\n  Area: 140.01\nSurface 10:\n  Type: Plane\n  Area: 140.01\nSurface 11:\n  Type: Plane\n  Area: 140.01\nSurface 12:\n  Type: Plane\n  Area: 140.01\nSurface 13:\n  Type: Plane\n  Area: 9800.00\nSurface 14:\n  Type: Plane\n  Area: 7640.50\nSurface 15:\n  Type: Plane\n  Area: 9800.00\n</var_identified_faces>\n<ideal_output>\n{\n  \"machining_analysis\": {\n    \"machining_process_selected\": \"Milling\",\n    \"setup_count\": 2,\n    \"tool_count\": 4,\n    \"operation_count\": 8,\n    \"machining_time\": 28.0 min,\n    \"toolpath_length\": 5360 mm,\n    \"part_data\": {\n      \"geometry\": {\n        \"main_body\": \"100x100x100mm\",\n        \"central_hole\": \"Ø50mm through\"\n      },\n      \"material\": \"Aluminum\",\n      \"stock_volume\": 1124864 mm3,\n      \"part_volume\": 803253 mm3,\n      \"material_to_remove\": 321611nmm3,\n      \"removal_percentage\": 28.6 %\n    },\n    \"process_details\": {\n      \"setup_1\": {\n        \"operations\": [\n          {\n            \"tool\": \"Face Mill (Ø80mm)\",\n            \"time\": 5.8,\n            \"description\": \"Face milling top surface: 104 x 104mm\",\n            \"toolpath\": 1040 mm\n          },\n          {\n            \"tool\": \"Roughing End Mill (Ø25mm)\",\n            \"time\": 8.4 min,\n            \"description\": \"Rough central hole: Ø50mm through\",\n            \"toolpath\": 1680 mm\n          },\n          {\n            \"tool\": \"Finishing End Mill (Ø20mm)\",\n            \"time\": 4.2 min,\n            \"description\": \"Finish hole walls\",\n            \"toolpath\": 840 mm\n          }\n        ],\n        \"total_time\": 18.4 min\n      },\n      \"setup_2\": {\n        \"operations\": [\n          {\n            \"tool\": \"Face Mill (Ø80mm)\",\n            \"time\": 5.8 min,\n            \"description\": \"Face milling bottom surface\",\n            \"toolpath\": 1040 mm\n          },\n          {\n            \"tool\": \"Finishing End Mill (Ø20mm)\",\n            \"time\": 3.8 min,\n            \"description\": \"Finish remaining surfaces\",\n            \"toolpath\": 760 mm\n          }\n        ],\n        \"total_time\": 9.6\n      }\n    },\n    \"setup_times\": {\n      \"machine_setup\": 20 min,\n      \"tool_setup\": 15 min,\n      \"work_setup\": 25min\n    }\n  },\n  \"justification\": {\n    \"machine_selection\": [\n      \"Part geometry is prismatic with simple features\",\n      \"Large size but within standard machine capacity\",\n      \"Through hole can be machined from both sides\",\n      \"Standard tooling sufficient for all features\",\n      \"Two setups adequate for complete machining\"\n    ],\n    \"calculation_considerations\": [\n      \"Material removal volume (321,611 mm³)\",\n      \"Aluminum cutting parameters\",\n      \"Conservative feed rates for quality\",\n      \"Multiple depth passes\",\n      \"Tool changes and setup times\",\n      \"Part size and weight for handling\"\n    ],\n    \"additional_notes\": \"The machining times and toolpath lengths are proportional to the material removal volume while maintaining appropriate cutting parameters for aluminum.\"\n  },\n  \"selected_machine\": \"CNC_3AXIS_STANDARD\"\n}\n</ideal_output>\n</example>\n<example>\n<var_material>\nMild Steel\n</var_material>\n<extra_features>\nNumber of threaded faces: 0\nNo threaded faces found.\n</extra_features>\n<var_cutting_para>\n{\n  \"material\": \"Mild Steel\",\n  \"cutting_parameters\": {\n    \"operations\": {\n      \"Milling\": {\n        \"End Mill\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 21.0,\n              \"max\": 30.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.025,\n              \"max\": 0.075\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 3.0\n            },\n            \"coolant_requirement\": \"Optional\",\n            \"special_notes\": \"General purpose machining\"\n          },\n          \"Carbide\": {\n            \"cutting_speed_range\": {\n              \"min\": 60.0,\n              \"max\": 150.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.05,\n              \"max\": 0.15\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Higher productivity\"\n          }\n        },\n        \"Face Mill\": {\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 100.0,\n              \"max\": 200.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.1,\n              \"max\": 0.25\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"For large surfaces\"\n          }\n        }\n      },\n      \"Turning\": {\n        \"External\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 15.0,\n              \"max\": 25.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.125,\n              \"max\": 0.25\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 3.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Basic turning operations\"\n          },\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 150.0,\n              \"max\": 250.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.4\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"High productivity turning\"\n          }\n        }\n      }\n    }\n  }\n}\n</var_cutting_para>\n<var_identified_faces>\nPart Analysis:\nVolume and Material Usage:\n- Part Volume: 361872.20 cubic units\n- Total Surface Area: 31887.17 square units\n- Raw Material Block Size (with 2mm margin):\n  * Length: 84.00 units\n  * Width: 84.00 units\n  * Height: 114.00 units\n- Raw Material Volume: 804384.01 cubic units\n- Material Removal Required: 442511.80 cubic units\n- Material Utilization: 45.0%\n\nFeature Summary:\nTotal Faces: 7\nBasic Surfaces:\n- 4 planar faces\n- 3 cylindrical faces\n- 0 conical faces\n- 0 spherical faces\n- 0 toroidal faces\n\nAdvanced Surfaces:\n- 0 Bezier surfaces\n- 0 B-Spline surfaces\n- 0 other surface types\n- 0 unidentified surfaces\n\nDetailed Surface Analysis:\nSurface 1:\n  Type: Cylinder\n  Area: 4241.15\n  Radius: 22.50\nSurface 2:\n  Type: Plane\n  Area: 1590.43\nSurface 3:\n  Type: Cylinder\n  Area: 7539.82\n  Radius: 30.00\nSurface 4:\n  Type: Plane\n  Area: 1237.00\nSurface 5:\n  Type: Cylinder\n  Area: 10053.10\n  Radius: 40.00\nSurface 6:\n  Type: Plane\n  Area: 2199.11\nSurface 7:\n  Type: Plane\n  Area: 5026.55\n</var_identified_faces>\n<ideal_output>\n\n{\n  \"machining_analysis\": {\n    \"machining_process_selected\": \"Turning\",\n    \"setup_count\": 2,\n    \"tool_count\": 3,\n    \"operation_count\": 6,\n    \"machining_time\": \"46.0 min\",\n    \"toolpath_length\": \"2570 mm\",\n    \"setup_times\": {\n      \"machine_setup\": \"20 min\",\n      \"tool_setup\": \"15 min\",\n      \"work_setup\": \"15 min\"\n    }\n  },\n  \"process_justification\": \"CNC turning selected for rotational symmetry\\nCutting parameters for steel:\\nRoughing: 120m/min, 0.2mm/rev feed\\nFinishing: 150m/min, 0.1mm/rev feed\",\n  \"selected_machining_in_general\": \"CNC Turning\",\n  \"justification\": \"2-axis CNC lathe sufficient because:\\nSimple stepped shaft geometry\\nNo milling features required\\nStandard turning operations only\\nMedium size part within typical lathe capacity\\nSteel material requires robust machine\",\n  \"selected_machine\": \"CNC_TURNING_2AXIS_STANDARD\"\n}\n</ideal_output>\n</example>\n<example>\n<var_material>\nAluminum\n</var_material>\n<extra_features>\nNumber of threaded faces: 0\nNo threaded faces found.\n</extra_features>\n<var_cutting_para>\n{\n  \"material\": \"Aluminum\",\n  \"cutting_parameters\": {\n    \"operations\": {\n      \"Milling\": {\n        \"End Mill\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 75.0,\n              \"max\": 105.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.05,\n              \"max\": 0.15\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Prevent chip welding\"\n          },\n          \"Carbide\": {\n            \"cutting_speed_range\": {\n              \"min\": 150.0,\n              \"max\": 600.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.075,\n              \"max\": 0.25\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"High speed capable\"\n          }\n        },\n        \"Face Mill\": {\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 300.0,\n              \"max\": 1000.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.4\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 6.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Polished rake face\"\n          }\n        }\n      },\n      \"Turning\": {\n        \"External\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 60.0,\n              \"max\": 90.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.35\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Sharp cutting edges\"\n          },\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 300.0,\n              \"max\": 800.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.2,\n              \"max\": 0.5\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 6.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"High polish tools\"\n          }\n        }\n      }\n    }\n  }\n}\n</var_cutting_para>\n<var_identified_faces>\nPart Analysis:\nVolume and Material Usage:\n- Part Volume: 361872.20 cubic units\n- Total Surface Area: 31887.17 square units\n- Raw Material Block Size (with 2mm margin):\n  * Length: 84.00 units\n  * Width: 84.00 units\n  * Height: 114.00 units\n- Raw Material Volume: 804384.01 cubic units\n- Material Removal Required: 442511.80 cubic units\n- Material Utilization: 45.0%\n\nFeature Summary:\nTotal Faces: 7\nBasic Surfaces:\n- 4 planar faces\n- 3 cylindrical faces\n- 0 conical faces\n- 0 spherical faces\n- 0 toroidal faces\n\nAdvanced Surfaces:\n- 0 Bezier surfaces\n- 0 B-Spline surfaces\n- 0 other surface types\n- 0 unidentified surfaces\n\nDetailed Surface Analysis:\nSurface 1:\n  Type: Cylinder\n  Area: 4241.15\n  Radius: 22.50\nSurface 2:\n  Type: Plane\n  Area: 1590.43\nSurface 3:\n  Type: Cylinder\n  Area: 7539.82\n  Radius: 30.00\nSurface 4:\n  Type: Plane\n  Area: 1237.00\nSurface 5:\n  Type: Cylinder\n  Area: 10053.10\n  Radius: 40.00\nSurface 6:\n  Type: Plane\n  Area: 2199.11\nSurface 7:\n  Type: Plane\n  Area: 5026.55\n</var_identified_faces>\n<ideal_output>\n{\n  \"machining_analysis\": {\n    \"machining_process_selected\": \"Turning\",\n    \"setup_count\": 2,\n    \"tool_count\": 3,\n    \"operation_count\": 6,\n    \"machining_time\": 24.8 min,\n    \"toolpath_length\": 1920 mm,\n    \"process_details\": {\n      \"setup_1\": {\n        \"operations\": [\n          {\n            \"name\": \"Rough turning\",\n            \"tool\": \"CNMG insert\",\n            \"length\": 1320 mm,\n            \"machining_time\": 9.2 min\n          },\n          {\n            \"name\": \"Finish turning\",\n            \"tool\": \"VNMG insert\",\n            \"length\": 110 mm,\n            \"machining_time\": 4.5 min\n          }\n        ],\n        \"total_toolpath_length\": 1430 mm,\n        \"total_machining_time\": 13.7 min\n      },\n      \"setup_2\": {\n        \"operations\": [\n          {\n            \"name\": \"Rough turning\",\n            \"tool\": \"CNMG insert\",\n            \"length\": 420 mm,\n            \"machining_time\": 7.3 min\n          },\n          {\n            \"name\": \"Finish turning\",\n            \"tool\": \"VNMG insert\",\n            \"length\": 70 mm,\n            \"machining_time\": 3.8  min\n          }\n        ],\n        \"total_toolpath_length\": 490 mm,\n        \"total_machining_time\": 11.1 min\n      }\n    },\n    \"setup_times\": {\n      \"machine_setup\": 20,\n      \"tool_setup\": 15,\n      \"work_setup\": 15\n    }\n  },\n  \"justification\": {\n    \"machine_selection\": \"2-axis CNC lathe selected due to purely rotational part geometry\",\n    \"machine_size\": \"Medium size part fits standard lathe\",\n    \"tool_selection\": [\n      \"CNMG insert for roughing operations\",\n      \"VNMG insert for finishing operations\",\n      \"Grooving tool for detail work\"\n    ],\n    \"setup_considerations\": {\n      \"part_weight\": \"~10kg aluminum\",\n      \"reference_surfaces\": \"Standard chuck mounting\",\n      \"alignment_requirements\": \"Basic\",\n      \"fixturing_needs\": \"No special fixtures needed\"\n    },\n    \"toolpath_notes\": \"Cutting parameters for aluminum: Roughing: 180m/min, 0.25mm/rev, Finishing: 220m/min, 0.15mm/rev\"\n  },\n  \"material_removal_volume\": 442512,\n  \"calculations\": {\n    \"perimeter\": \"Cylindrical sections: Top Ø45mm, Middle Ø60mm, Bottom Ø80mm\",\n    \"radial_passes\": \"Multiple passes required for diameter reductions\",\n    \"depth_passes\": \"Total height ~110mm with stepped cylindrical geometry\"\n  }\n}\n</ideal_output>\n</example>\n<example>\n<var_material>\nMild Steel\n</var_material>\n<extra_features>\nNumber of threaded faces: 0\nNo threaded faces found.\n</extra_features>\n<var_cutting_para>\n{\n  \"material\": \"Mild Steel\",\n  \"cutting_parameters\": {\n    \"operations\": {\n      \"Milling\": {\n        \"End Mill\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 21.0,\n              \"max\": 30.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.025,\n              \"max\": 0.075\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 3.0\n            },\n            \"coolant_requirement\": \"Optional\",\n            \"special_notes\": \"General purpose machining\"\n          },\n          \"Carbide\": {\n            \"cutting_speed_range\": {\n              \"min\": 60.0,\n              \"max\": 150.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.05,\n              \"max\": 0.15\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Higher productivity\"\n          }\n        },\n        \"Face Mill\": {\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 100.0,\n              \"max\": 200.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.1,\n              \"max\": 0.25\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"For large surfaces\"\n          }\n        }\n      },\n      \"Turning\": {\n        \"External\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 15.0,\n              \"max\": 25.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.125,\n              \"max\": 0.25\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 3.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Basic turning operations\"\n          },\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 150.0,\n              \"max\": 250.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.4\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"High productivity turning\"\n          }\n        }\n      }\n    }\n  }\n}\n</var_cutting_para>\n<var_identified_faces>\nPart Analysis:\nVolume and Material Usage:\n- Part Volume: 2894149.30 cubic units\n- Total Surface Area: 126568.10 square units\n- Raw Material Block Size (with 2mm margin):\n  * Length: 164.00 units\n  * Width: 164.00 units\n  * Height: 224.00 units\n- Raw Material Volume: 6024704.02 cubic units\n- Material Removal Required: 3130554.72 cubic units\n- Material Utilization: 48.0%\n\nFeature Summary:\nTotal Faces: 11\nBasic Surfaces:\n- 4 planar faces\n- 3 cylindrical faces\n- 4 conical faces\n- 0 spherical faces\n- 0 toroidal faces\n\nAdvanced Surfaces:\n- 0 Bezier surfaces\n- 0 B-Spline surfaces\n- 0 other surface types\n- 0 unidentified surfaces\n\nDetailed Surface Analysis:\nSurface 1:\n  Type: Cone\n  Area: 706.42\n  Radius: 79.50\n  Semi-Angle: 0.79\nSurface 2:\n  Type: Cylinder\n  Area: 39207.08\n  Radius: 80.00\nSurface 3:\n  Type: Plane\n  Area: 8296.95\nSurface 4:\n  Type: Cone\n  Area: 528.70\n  Radius: 59.50\n  Semi-Angle: 0.79\nSurface 5:\n  Type: Cylinder\n  Area: 29782.30\n  Radius: 60.00\nSurface 6:\n  Type: Plane\n  Area: 4574.16\nSurface 7:\n  Type: Cone\n  Area: 706.42\n  Radius: 79.50\n  Semi-Angle: 0.79\nSurface 8:\n  Type: Plane\n  Area: 19606.68\nSurface 9:\n  Type: Cone\n  Area: 395.42\n  Radius: 44.50\n  Semi-Angle: 0.79\nSurface 10:\n  Type: Cylinder\n  Area: 16681.86\n  Radius: 45.00\nSurface 11:\n  Type: Plane\n  Area: 6082.12\n</var_identified_faces>\n<ideal_output>\n{\n  \"machining_analysis\": {\n    \"machining_process_selected\": \"Turning\",\n    \"setup_count\": 2,\n    \"tool_count\": 4,\n    \"operation_count\": 8,\n    \"machining_time\": 125.1 min ,\n    \"toolpath_length\": 8620 mm,\n    \"process_details\": {\n      \"setup_1\": {\n        \"operations\": [\n          {\n            \"name\": \"Rough turning\",\n            \"tool\": \"CNMG insert\",\n            \"length\": 4400 mm,\n            \"machining_time\": 45.6 min\n          },\n          {\n            \"name\": \"Finish turning\",\n            \"tool\": \"VNMG insert\",\n            \"length\": 880 mm,\n            \"machining_time\": 22.8 min\n          }\n        ],\n        \"total_toolpath_length\": 5280 mm ,\n        \"total_machining_time\": 68.4 min\n      },\n      \"setup_2\": {\n        \"operations\": [\n          {\n            \"name\": \"Rough turning\",\n            \"tool\": \"CNMG insert\",\n            \"length\": 2520 mm,\n            \"machining_time\": 38.5 min\n          },\n          {\n            \"name\": \"Finish turning\",\n            \"tool\": \"VNMG insert\",\n            \"length\": 820 mm,\n            \"machining_time\": 18.2 min\n          }\n        ],\n        \"total_toolpath_length\": 3340 mm,\n        \"total_machining_time\": 56.7 min\n      }\n    },\n    \"setup_times\": {\n      \"machine_setup\": 30,\n      \"tool_setup\": 20,\n      \"work_setup\": 25\n    }\n  },\n  \"justification\": {\n    \"machine_selection\": \"Large CNC lathe selected due to part size requiring heavy-duty machine\",\n    \"machine_size\": \"Weight requires lifting equipment, steel cutting parameters need rigid setup\",\n    \"tool_selection\": [\n      \"CNMG insert for rough turning operations\",\n      \"VNMG insert for finish turning operations\",\n      \"Grooving tool for detail work\",\n      \"Boring tool for internal features\"\n    ],\n    \"setup_considerations\": {\n      \"part_weight\": \"Heavy steel part requiring lifting equipment\",\n      \"reference_surfaces\": \"Multiple\",\n      \"alignment_requirements\": \"Feature accessibility possible in 2 setups\",\n      \"fixturing_needs\": \"Rigid setup for steel cutting parameters\"\n    },\n    \"toolpath_notes\": \"Toolpath calculation based on large volume of material removal, steel cutting parameters, multiple roughing passes needed, and conservative feeds/speeds for steel\"\n  },\n  \"material_removal_volume\": 3130554.72,\n  \"calculations\": {\n    \"perimeter\": \"Multiple cylindrical and conical sections with varying diameters\",\n    \"radial_passes\": \"Multiple passes required for diameter reductions (164mm to 160mm)\",\n    \"depth_passes\": \"Multiple depth passes across 220mm length\"\n  }\n}\n</ideal_output>\n</example>\n<example>\n<var_material>\nMild Steel\n</var_material>\n<extra_features>\nNumber of threaded faces: 0\nNo threaded faces found.\n</extra_features>\n<var_cutting_para>\n{\n  \"material\": \"Mild Steel\",\n  \"cutting_parameters\": {\n    \"operations\": {\n      \"Milling\": {\n        \"End Mill\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 21.0,\n              \"max\": 30.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.025,\n              \"max\": 0.075\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 3.0\n            },\n            \"coolant_requirement\": \"Optional\",\n            \"special_notes\": \"General purpose machining\"\n          },\n          \"Carbide\": {\n            \"cutting_speed_range\": {\n              \"min\": 60.0,\n              \"max\": 150.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.05,\n              \"max\": 0.15\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Higher productivity\"\n          }\n        },\n        \"Face Mill\": {\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 100.0,\n              \"max\": 200.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.1,\n              \"max\": 0.25\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"For large surfaces\"\n          }\n        }\n      },\n      \"Turning\": {\n        \"External\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 15.0,\n              \"max\": 25.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.125,\n              \"max\": 0.25\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 3.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Basic turning operations\"\n          },\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 150.0,\n              \"max\": 250.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.4\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"High productivity turning\"\n          }\n        }\n      }\n    }\n  }\n}\n</var_cutting_para>\n<var_identified_faces>\nPart Analysis:\nVolume and Material Usage:\n- Part Volume: 45234.03 cubic mm\n- Total Surface Area: 7971.79 square mm\n- Raw Material Block Size (with 2mm margin):\n  * Length: 44.00 units\n  * Width: 44.00 units\n  * Height: 59.00 units\n- Raw Material Volume: 114224.00 cubic units\n- Material Removal Required: 68989.98 cubic units\n- Material Utilization: 39.6%\n\nFeature Summary:\nTotal Faces: 7\nBasic Surfaces:\n- 4 planar faces\n- 3 cylindrical faces\n- 0 conical faces\n- 0 spherical faces\n- 0 toroidal faces\n\nAdvanced Surfaces:\n- 0 Bezier surfaces\n- 0 B-Spline surfaces\n- 0 other surface types\n- 0 unidentified surfaces\n\nDetailed Surface Analysis:\nSurface 1:\n  Type: Cylinder\n  Area: 1060.29\n  Radius: 11.25\nSurface 2:\n  Type: Plane\n  Area: 397.61\nSurface 3:\n  Type: Cylinder\n  Area: 1884.96\n  Radius: 15.00\nSurface 4:\n  Type: Plane\n  Area: 309.25\nSurface 5:\n  Type: Cylinder\n  Area: 2513.27\n  Radius: 20.00\nSurface 6:\n  Type: Plane\n  Area: 549.78\nSurface 7:\n  Type: Plane\n  Area: 1256.64\n</var_identified_faces>\n<ideal_output>\n{\n  \"machining_analysis\": {\n    \"machining_process_selected\": \"Turning\",\n    \"setup_count\": 2,\n    \"tool_count\": 3,\n    \"operation_count\": 6,\n    \"machining_time\": 31.7 min,\n    \"toolpath_length\": 1485 mm,\n    \"process_details\": {\n      \"setup_1\": {\n        \"operations\": [\n          {\n            \"name\": \"Rough turning\",\n            \"tool\": \"CNMG insert\",\n            \"length\": 880 mm,\n            \"machining_time\": 12.5 min\n          },\n          {\n            \"name\": \"Finish turning\",\n            \"tool\": \"VNMG insert\",\n            \"length\": 55 mm,\n            \"machining_time\": 6.2 min\n          }\n        ],\n        \"total_toolpath_length\": 935 mm,\n        \"total_machining_time\": 18.7 min\n      },\n      \"setup_2\": {\n        \"operations\": [\n          {\n            \"name\": \"Rough turning\",\n            \"tool\": \"CNMG insert\",\n            \"length\": 495 mm,\n            \"machining_time\": 10.8 min\n          },\n          {\n            \"name\": \"Finish turning\",\n            \"tool\": \"VNMG insert\",\n            \"length\": 55 mm,\n            \"machining_time\": 5.5 min\n          }\n        ],\n        \"total_toolpath_length\": 550 mm,\n        \"total_machining_time\": 16.3 min\n      }\n    },\n    \"setup_times\": {\n      \"machine_setup\": 20,\n      \"tool_setup\": 15,\n      \"work_setup\": 15\n    }\n  },\n  \"justification\": {\n    \"machine_selection\": \"2-axis CNC lathe sufficient because of simple stepped shaft geometry\",\n    \"machine_size\": \"Medium size part within typical lathe capacity\",\n    \"tool_selection\": [\n      \"CNMG insert for rough turning operations\",\n      \"VNMG insert for finish turning operations\"\n    ],\n    \"setup_considerations\": {\n      \"part_weight\": \"Steel material requires robust machine\",\n      \"reference_surfaces\": \"Standard turning operations only\",\n      \"alignment_requirements\": \"Basic\",\n      \"fixturing_needs\": \"Standard\"\n    },\n    \"toolpath_notes\": \"Steel cutting parameters: Roughing: 120m/min, 0.2mm/rev feed, Finishing: 150m/min, 0.1mm/rev feed\"\n  },\n  \"material_removal_volume\": 68990,\n  \"calculations\": {\n    \"perimeter\": \"Three stepped cylindrical sections: Top: Ø22.5mm, Middle: Ø30mm, Bottom: Ø40mm\",\n    \"radial_passes\": \"Diameter reduction: 44mm to 40mm = 4mm depth\",\n    \"depth_passes\": \"Multiple passes across stepped profile\"\n  }\n}\n</ideal_output>\n</example>\n<example>\n<var_material>\nAluminum\n</var_material>\n<extra_features>\nNumber of threaded faces: 0\nNo threaded faces found.\n</extra_features>\n<var_cutting_para>\n{\n  \"material\": \"Aluminum\",\n  \"cutting_parameters\": {\n    \"operations\": {\n      \"Milling\": {\n        \"End Mill\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 75.0,\n              \"max\": 105.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.05,\n              \"max\": 0.15\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Prevent chip welding\"\n          },\n          \"Carbide\": {\n            \"cutting_speed_range\": {\n              \"min\": 150.0,\n              \"max\": 600.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.075,\n              \"max\": 0.25\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"High speed capable\"\n          }\n        },\n        \"Face Mill\": {\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 300.0,\n              \"max\": 1000.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.4\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 6.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Polished rake face\"\n          }\n        }\n      },\n      \"Turning\": {\n        \"External\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 60.0,\n              \"max\": 90.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.35\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Sharp cutting edges\"\n          },\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 300.0,\n              \"max\": 800.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.2,\n              \"max\": 0.5\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 6.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"High polish tools\"\n          }\n        }\n      }\n    }\n  }\n}\n</var_cutting_para>\n<var_identified_faces>\nPart Analysis:\nVolume and Material Usage:\n- Part Volume: 77536.15 cubic units\n- Total Surface Area: 28586.02 square units\n- Raw Material Block Size (with 2mm margin):\n  * Length: 80.74 units\n  * Width: 79.00 units\n  * Height: 92.00 units\n- Raw Material Volume: 586782.39 cubic units\n- Material Removal Required: 509246.24 cubic units\n- Material Utilization: 13.2%\n\nFeature Summary:\nTotal Faces: 32\nBasic Surfaces:\n- 14 planar faces\n- 18 cylindrical faces\n- 0 conical faces\n- 0 spherical faces\n- 0 toroidal faces\n\nAdvanced Surfaces:\n- 0 Bezier surfaces\n- 0 B-Spline surfaces\n- 0 other surface types\n- 0 unidentified surfaces\n\nDetailed Surface Analysis:\nSurface 1:\n  Type: Cylinder\n  Area: 2601.24\n  Radius: 23.00\nSurface 2:\n  Type: Cylinder\n  Area: 5372.12\n  Radius: 19.00\nSurface 3:\n  Type: Cylinder\n  Area: 188.50\n  Radius: 6.00\nSurface 4:\n  Type: Plane\n  Area: 727.46\nSurface 5:\n  Type: Cylinder\n  Area: 188.50\n  Radius: 6.00\nSurface 6:\n  Type: Plane\n  Area: 727.46\nSurface 7:\n  Type: Cylinder\n  Area: 188.50\n  Radius: 6.00\nSurface 8:\n  Type: Plane\n  Area: 727.46\nSurface 9:\n  Type: Plane\n  Area: 942.83\nSurface 10:\n  Type: Plane\n  Area: 770.83\nSurface 11:\n  Type: Cylinder\n  Area: 73.65\n  Radius: 41.00\nSurface 12:\n  Type: Plane\n  Area: 348.72\nSurface 13:\n  Type: Cylinder\n  Area: 73.65\n  Radius: 41.00\nSurface 14:\n  Type: Plane\n  Area: 348.72\nSurface 15:\n  Type: Cylinder\n  Area: 73.65\n  Radius: 41.00\nSurface 16:\n  Type: Cylinder\n  Area: 120.95\n  Radius: 3.50\nSurface 17:\n  Type: Cylinder\n  Area: 120.95\n  Radius: 3.50\nSurface 18:\n  Type: Plane\n  Area: 348.72\nSurface 19:\n  Type: Cylinder\n  Area: 120.95\n  Radius: 3.50\nSurface 20:\n  Type: Plane\n  Area: 1590.40\nSurface 21:\n  Type: Plane\n  Area: 1518.93\nSurface 22:\n  Type: Plane\n  Area: 628.32\nSurface 23:\n  Type: Cylinder\n  Area: 636.17\n  Radius: 22.50\nSurface 24:\n  Type: Cylinder\n  Area: 5309.29\n  Radius: 13.00\nSurface 25:\n  Type: Plane\n  Area: 431.18\nSurface 26:\n  Type: Cylinder\n  Area: 2309.07\n  Radius: 17.50\nSurface 27:\n  Type: Plane\n  Area: 431.18\nSurface 28:\n  Type: Cylinder\n  Area: 219.91\n  Radius: 17.50\nSurface 29:\n  Type: Cylinder\n  Area: 306.31\n  Radius: 3.25\nSurface 30:\n  Type: Cylinder\n  Area: 306.31\n  Radius: 3.25\nSurface 31:\n  Type: Cylinder\n  Area: 306.31\n  Radius: 3.25\nSurface 32:\n  Type: Plane\n  Area: 527.79\n</var_identified_faces>\n<ideal_output>\n{\n  \"machining_analysis\": {\n    \"machining_process_selected\": \"Turn-Mill\",\n    \"setup_count\": 2,\n    \"tool_count\": 7,\n    \"operation_count\": 14,\n    \"machining_time\": 71.7 min,\n    \"toolpath_length\": 18040 mm,\n    \"process_details\": {\n      \"setup_1\": {\n        \"operations\": [\n          {\n            \"name\": \"Rough turning\",\n            \"tool\": \"CNMG insert\",\n            \"length\": 4800 mm,\n            \"machining_time\": 18.5 min\n          },\n          {\n            \"name\": \"Semi-finish turning\",\n            \"tool\": \"VNMG insert\",\n            \"length\": 2200 mm,\n            \"machining_time\": 8.2 min\n          },\n          {\n            \"name\": \"Milling operations\",\n            \"tool\": \"Ø16 End Mill\",\n            \"length\": 3600 mm,\n            \"machining_time\": 12.4 min\n          },\n          {\n            \"name\": \"Drilling operations\",\n            \"tool\": \"Drill bits\",\n            \"length\": 840 mm,\n            \"machining_time\": 4.8 min\n          }\n        ],\n        \"total_toolpath_length\": 11440,\n        \"total_machining_time\": 43.9\n      },\n      \"setup_2\": {\n        \"operations\": [\n          {\n            \"name\": \"Rough turning\",\n            \"tool\": \"CNMG insert\",\n            \"length\": 3200 mm,\n            \"machining_time\": 12.6 min\n          },\n          {\n            \"name\": \"Finish turning\",\n            \"tool\": \"VNMG insert\",\n            \"length\": 1800 mm,\n            \"machining_time\": 6.8 min\n          },\n          {\n            \"name\": \"Milling/drilling operations\",\n            \"tool\": \"Various\",\n            \"length\": 1600 mm,\n            \"machining_time\": 8.4 min\n          }\n        ],\n        \"total_toolpath_length\": 6600 mm,\n        \"total_machining_time\": 27.8 min\n      }\n    },\n    \"setup_times\": {\n      \"machine_setup\": 25 min,\n      \"tool_setup\": 20 min,\n      \"work_setup\": 15 min\n    }\n  },\n  \"justification\": {\n    \"machine_selection\": \"Turn-Mill center selected due to complex part with both turning and milling features\",\n    \"machine_size\": \"Part size suits medium machine capacity\",\n    \"tool_selection\": [\n      \"CNMG insert for rough turning operations\",\n      \"VNMG insert for finish turning operations\",\n      \"End mills for milling features\",\n      \"Drill bits for hole features\"\n    ],\n    \"setup_considerations\": {\n      \"part_weight\": \"Aluminum material with complex handling\",\n      \"reference_surfaces\": \"Multiple surfaces require precision alignment\",\n      \"alignment_requirements\": \"In-process measurements needed\",\n      \"fixturing_needs\": \"Complex part handling\"\n    },\n    \"toolpath_notes\": \"High material removal rate needed (86.8% stock removal), multiple holes and features require mill-turn capability\"\n  },\n  \"material_removal_volume\": 509246 mm3,\n  \"calculations\": {\n    \"perimeter\": \"Main body diameter: Ø46mm with multiple cylindrical features (18 surfaces)\",\n    \"radial_passes\": \"Multiple passes for large stock removal\",\n    \"depth_passes\": \"Conservative feed rates for good surface finish\"\n  }\n}\n</ideal_output>\n</example>\n<example>\n<var_material>\nCast Iron \n</var_material>\n<extra_features>\nNumber of threaded faces: 0\nNo threaded faces found.\n</extra_features>\n<var_cutting_para>\n{\n  \"material\": \"Cast Iron\",\n  \"cutting_parameters\": {\n    \"operations\": {\n      \"Milling\": {\n        \"End Mill\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 24.0,\n              \"max\": 45.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.05,\n              \"max\": 0.1\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 3.0\n            },\n            \"coolant_requirement\": \"Optional\",\n            \"special_notes\": \"Dry cutting possible\"\n          },\n          \"Carbide\": {\n            \"cutting_speed_range\": {\n              \"min\": 80.0,\n              \"max\": 200.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.075,\n              \"max\": 0.2\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Optional\",\n            \"special_notes\": \"Good chip evacuation needed\"\n          }\n        },\n        \"Face Mill\": {\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 120.0,\n              \"max\": 250.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.125,\n              \"max\": 0.3\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Optional\",\n            \"special_notes\": \"Watch for dust\"\n          }\n        }\n      },\n      \"Turning\": {\n        \"External\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 20.0,\n              \"max\": 30.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.3\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 3.0\n            },\n            \"coolant_requirement\": \"Optional\",\n            \"special_notes\": \"Good for interrupted cuts\"\n          },\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 180.0,\n              \"max\": 300.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.2,\n              \"max\": 0.45\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Optional\",\n            \"special_notes\": \"High material removal\"\n          }\n        }\n      }\n    }\n  }\n}\n</var_cutting_para>\n<var_identified_faces>\nPart Analysis:\nVolume and Material Usage:\n- Part Volume: 77536.15 cubic units\n- Total Surface Area: 28586.02 square units\n- Raw Material Block Size (with 2mm margin):\n  * Length: 80.74 units\n  * Width: 79.00 units\n  * Height: 92.00 units\n- Raw Material Volume: 586782.39 cubic units\n- Material Removal Required: 509246.24 cubic units\n- Material Utilization: 13.2%\n\nFeature Summary:\nTotal Faces: 32\nBasic Surfaces:\n- 14 planar faces\n- 18 cylindrical faces\n- 0 conical faces\n- 0 spherical faces\n- 0 toroidal faces\n\nAdvanced Surfaces:\n- 0 Bezier surfaces\n- 0 B-Spline surfaces\n- 0 other surface types\n- 0 unidentified surfaces\n\nDetailed Surface Analysis:\nSurface 1:\n  Type: Cylinder\n  Area: 2601.24\n  Radius: 23.00\nSurface 2:\n  Type: Cylinder\n  Area: 5372.12\n  Radius: 19.00\nSurface 3:\n  Type: Cylinder\n  Area: 188.50\n  Radius: 6.00\nSurface 4:\n  Type: Plane\n  Area: 727.46\nSurface 5:\n  Type: Cylinder\n  Area: 188.50\n  Radius: 6.00\nSurface 6:\n  Type: Plane\n  Area: 727.46\nSurface 7:\n  Type: Cylinder\n  Area: 188.50\n  Radius: 6.00\nSurface 8:\n  Type: Plane\n  Area: 727.46\nSurface 9:\n  Type: Plane\n  Area: 942.83\nSurface 10:\n  Type: Plane\n  Area: 770.83\nSurface 11:\n  Type: Cylinder\n  Area: 73.65\n  Radius: 41.00\nSurface 12:\n  Type: Plane\n  Area: 348.72\nSurface 13:\n  Type: Cylinder\n  Area: 73.65\n  Radius: 41.00\nSurface 14:\n  Type: Plane\n  Area: 348.72\nSurface 15:\n  Type: Cylinder\n  Area: 73.65\n  Radius: 41.00\nSurface 16:\n  Type: Cylinder\n  Area: 120.95\n  Radius: 3.50\nSurface 17:\n  Type: Cylinder\n  Area: 120.95\n  Radius: 3.50\nSurface 18:\n  Type: Plane\n  Area: 348.72\nSurface 19:\n  Type: Cylinder\n  Area: 120.95\n  Radius: 3.50\nSurface 20:\n  Type: Plane\n  Area: 1590.40\nSurface 21:\n  Type: Plane\n  Area: 1518.93\nSurface 22:\n  Type: Plane\n  Area: 628.32\nSurface 23:\n  Type: Cylinder\n  Area: 636.17\n  Radius: 22.50\nSurface 24:\n  Type: Cylinder\n  Area: 5309.29\n  Radius: 13.00\nSurface 25:\n  Type: Plane\n  Area: 431.18\nSurface 26:\n  Type: Cylinder\n  Area: 2309.07\n  Radius: 17.50\nSurface 27:\n  Type: Plane\n  Area: 431.18\nSurface 28:\n  Type: Cylinder\n  Area: 219.91\n  Radius: 17.50\nSurface 29:\n  Type: Cylinder\n  Area: 306.31\n  Radius: 3.25\nSurface 30:\n  Type: Cylinder\n  Area: 306.31\n  Radius: 3.25\nSurface 31:\n  Type: Cylinder\n  Area: 306.31\n  Radius: 3.25\nSurface 32:\n  Type: Plane\n  Area: 527.79\n</var_identified_faces>\n<ideal_output>\n{\n  \"machining_analysis\": {\n    \"machining_process_selected\": \"CNC Turn-Mill Center\",\n    \"setup_count\": 3,\n    \"tool_count\": 8,\n    \"operation_count\": 14,\n    \"machining_time\": 124.3 min,\n    \"toolpath_length\": 22946mm,\n    \"process_details\": {\n      \"setup_1\": {\n        \"operations\": [\n          {\n            \"name\": \"Rough turning\",\n            \"tool\": \"CNMG insert\",\n            \"length\": 2400 mm,\n            \"machining_time\": 25.4 min\n          },\n          {\n            \"name\": \"Semi-finish turning\",\n            \"tool\": \"DNMG insert\",\n            \"length\": 1200 mm,\n            \"machining_time\": 12.6 min\n          },\n          {\n            \"name\": \"Finish turning\",\n            \"tool\": \"VNMG insert\",\n            \"length\": 800 mm,\n            \"machining_time\": 8.2 min\n          }\n        ],\n        \"total_toolpath_length\": 4400 mm,\n        \"total_machining_time\": 46.2 min\n      },\n      \"setup_2\": {\n        \"operations\": [\n          {\n            \"name\": \"Milling operations\",\n            \"tool\": \"Ø20 End Mill\",\n            \"length\": 3600 mm,\n            \"machining_time\": 18.4 min\n          },\n          {\n            \"name\": \"Drilling operations\",\n            \"tool\": \"Ø12, Ø7, Ø6.5 drills\",\n            \"length\": 1200 mm,\n            \"machining_time\": 12.8 min\n          }\n        ],\n        \"total_toolpath_length\": 4800 mm,\n        \"total_machining_time\": 31.2 min\n      },\n      \"setup_3\": {\n        \"operations\": [\n          {\n            \"name\": \"Back face finishing\",\n            \"tool\": \"Finishing tools\",\n            \"length\": 1800 mm,\n            \"machining_time\": 15.6 min\n          }\n        ],\n        \"total_toolpath_length\": 1800 mm,\n        \"total_machining_time\": 15.6 min\n      }\n    },\n    \"setup_times\": {\n      \"machine_setup\": 25,\n      \"tool_setup\": 20,\n      \"work_setup\": 30\n    }\n  },\n  \"justification\": {\n    \"machine_selection\": \"CNC Turn-Mill center selected due to complex part requiring both turning and milling operations\",\n    \"machine_size\": \"Cast iron requires robust machine capability\",\n    \"tool_selection\": [\n      \"CNMG insert for rough turning operations\",\n      \"DNMG insert for semi-finish turning\",\n      \"VNMG insert for finish turning\",\n      \"End mills for milling features\",\n      \"Various drill bits for hole features\"\n    ],\n    \"setup_considerations\": {\n      \"part_weight\": \"Cast iron material is heavier than aluminum\",\n      \"reference_surfaces\": \"Complex feature access requirements\",\n      \"alignment_requirements\": \"In-process measurement requirements\",\n      \"fixturing_needs\": \"Setup complexity and alignment needs\"\n    },\n    \"toolpath_notes\": \"Slower cutting speeds for cast iron, multiple depth passes for heavy material removal, high material removal rate needed (86.8% stock removal)\"\n  },\n  \"material_removal_volume\": 509246,\n  \"calculations\": {\n    \"perimeter\": \"Main cylindrical body with Ø46mm, secondary cylindrical sections (Ø38mm, Ø44mm)\",\n    \"radial_passes\": \"Multiple depth passes for heavy material removal\",\n    \"depth_passes\": \"Tool wear considerations required for cast iron\"\n  }\n}\n</ideal_output>\n</example>\n<example>\n<var_material>\nMild Steel\n</var_material>\n<extra_features>\nNumber of threaded faces: 1\n<Part::PartFeature>\n</extra_features>\n<var_cutting_para>\n{\n  \"material\": \"Mild Steel\",\n  \"cutting_parameters\": {\n    \"operations\": {\n      \"Milling\": {\n        \"End Mill\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 21.0,\n              \"max\": 30.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.025,\n              \"max\": 0.075\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 3.0\n            },\n            \"coolant_requirement\": \"Optional\",\n            \"special_notes\": \"General purpose machining\"\n          },\n          \"Carbide\": {\n            \"cutting_speed_range\": {\n              \"min\": 60.0,\n              \"max\": 150.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.05,\n              \"max\": 0.15\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Higher productivity\"\n          }\n        },\n        \"Face Mill\": {\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 100.0,\n              \"max\": 200.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.1,\n              \"max\": 0.25\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"For large surfaces\"\n          }\n        }\n      },\n      \"Turning\": {\n        \"External\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 15.0,\n              \"max\": 25.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.125,\n              \"max\": 0.25\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 3.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Basic turning operations\"\n          },\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 150.0,\n              \"max\": 250.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.4\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"High productivity turning\"\n          }\n        }\n      }\n    }\n  }\n}\n</var_cutting_para>\n<var_identified_faces>\nPart Analysis:\nVolume and Material Usage:\n- Part Volume: 8736.38 cubic units\n- Total Surface Area: 4995.31 square units\n- Raw Material Block Size (with 2mm margin):\n  * Length: 29.80 units\n  * Width: 44.00 units\n  * Height: 44.00 units\n- Raw Material Volume: 57695.51 cubic units\n- Material Removal Required: 48959.13 cubic units\n- Material Utilization: 15.1%\n\nFeature Summary:\nTotal Faces: 23\nBasic Surfaces:\n- 9 planar faces\n- 8 cylindrical faces\n- 2 conical faces\n- 0 spherical faces\n- 0 toroidal faces\n\nAdvanced Surfaces:\n- 0 Bezier surfaces\n- 4 B-Spline surfaces\n- 0 other surface types\n- 0 unidentified surfaces\n\nDetailed Surface Analysis:\nSurface 1:\n  Type: Cone\n  Area: 87.75\n  Radius: 19.48\n  Semi-Angle: 0.79\nSurface 2:\n  Type: Cone\n  Area: 87.75\n  Radius: 19.48\n  Semi-Angle: 0.79\nSurface 3:\n  Type: Cylinder\n  Area: 43.69\n  Radius: 2.50\nSurface 4:\n  Type: Cylinder\n  Area: 502.65\n  Radius: 20.00\nSurface 5:\n  Type: Cylinder\n  Area: 120.95\n  Radius: 7.00\nSurface 6:\n  Type: Cylinder\n  Area: 24.74\n  Radius: 7.00\nSurface 7:\n  Type: Cylinder\n  Area: 215.83\n  Radius: 12.50\nSurface 8:\n  Type: Cylinder\n  Area: 215.83\n  Radius: 12.50\nSurface 9:\n  Type: Plane\n  Area: 162.48\nSurface 10:\n  Type: Plane\n  Area: 162.48\nSurface 11:\n  Type: Plane\n  Area: 248.15\nSurface 12:\n  Type: Plane\n  Area: 153.94\nSurface 13:\n  Type: Plane\n  Area: 0.95\nSurface 14:\n  Type: BSpline\n  Area: 360.90\n  U Degree: 2\n  V Degree: 1\n  Control Points: 322\nSurface 15:\n  Type: BSpline\n  Area: 335.06\n  U Degree: 2\n  V Degree: 1\n  Control Points: 322\nSurface 16:\n  Type: Cylinder\n  Area: 73.68\n  Radius: 8.08\nSurface 17:\n  Type: Plane\n  Area: 770.45\nSurface 18:\n  Type: Plane\n  Area: 19.63\nSurface 19:\n  Type: Plane\n  Area: 0.24\nSurface 20:\n  Type: Cylinder\n  Area: 27.59\n  Radius: 3.04\nSurface 21:\n  Type: BSpline\n  Area: 102.55\n  U Degree: 2\n  V Degree: 1\n  Control Points: 322\nSurface 22:\n  Type: BSpline\n  Area: 107.10\n  U Degree: 2\n  V Degree: 1\n  Control Points: 322\nSurface 23:\n  Type: Plane\n  Area: 1170.93\n</var_identified_faces>\n<ideal_output>\n{\n  \"machining_analysis\": {\n    \"machining_process_selected\": \"Turn-Milling\",\n    \"setup_count\": 2,\n    \"tool_count\": 6,\n    \"operation_count\": 12,\n    \"machining_time\": 68.3 min,\n    \"toolpath_length\": 12800 mm,\n    \"process_details\": {\n      \"setup_1\": {\n        \"operations\": [\n          {\n            \"name\": \"Rough turning\",\n            \"tool\": \"CNMG insert\",\n            \"length\": 3600 mm,\n            \"machining_time\": 22.5 min\n          },\n          {\n            \"name\": \"Semi-finish turning\",\n            \"tool\": \"VNMG insert\",\n            \"length\": 1800 mm,\n            \"machining_time\": 12.4 min\n          },\n          {\n            \"name\": \"Milling operations\",\n            \"tool\": \"Ø16 End Mill\",\n            \"length\": 2400 mm,\n            \"machining_time\": 15.6 min\n          },\n          {\n            \"name\": \"Drilling operations\",\n            \"tool\": \"Drill bits\",\n            \"length\": 600 mm,\n            \"machining_time\": 8.5 min\n          }\n        ],\n        \"total_toolpath_length\": 8400 mm,\n        \"total_machining_time\": 59.0 min\n      },\n      \"setup_2\": {\n        \"operations\": [\n          {\n            \"name\": \"Threading operations\",\n            \"tool\": \"Threading tools\",\n            \"length\": 2800 mm,\n            \"machining_time\": 18.5 min\n          },\n          {\n            \"name\": \"Finishing operations\",\n            \"tool\": \"Finishing tools\",\n            \"length\": 1600 mm,\n            \"machining_time\": 12.8 min\n          }\n        ],\n        \"total_toolpath_length\": 4400 mm,\n        \"total_machining_time\": 31.3 min\n      }\n    },\n    \"setup_times\": {\n      \"machine_setup\": 25 min, \n      \"tool_setup\": 20 min,\n      \"work_setup\": 20 min\n    }\n  },\n  \"justification\": {\n    \"machine_selection\": \"CNC Turn-Mill center selected due to complex geometry requiring both turning and milling\",\n    \"machine_size\": \"Steel material requires robust machine capability\",\n    \"tool_selection\": [\n      \"CNMG insert for rough turning operations\",\n      \"VNMG insert for semi-finish turning\",\n      \"End mills for milling features\",\n      \"Drill bits for hole features\",\n      \"Threading tools for threads\",\n      \"Finishing tools for final operations\"\n    ],\n    \"setup_considerations\": {\n      \"part_weight\": \"Mild Steel material\",\n      \"reference_surfaces\": \"Complex feature accessibility\",\n      \"alignment_requirements\": \"In-process measurements needed\",\n      \"fixturing_needs\": \"Setup complexity\"\n    },\n    \"toolpath_notes\": \"B-spline surfaces need simultaneous axis control, lower speeds than aluminum, multiple depth passes, conservative feed rates, abundant coolant required\"\n  },\n  \"material_removal_volume\": 48959.13 mm3,\n  \"calculations\": {\n    \"perimeter\": \"Multiple cylindrical surfaces (8), largest diameter: Ø40mm (R20mm)\",\n    \"radial_passes\": \"Multiple passes needed for 84.9% material removal\",\n    \"depth_passes\": \"Tool wear considerations for steel material\"\n  }\n}\n</ideal_output>\n</example>\n<example>\n<var_material>\nAluminum\n</var_material>\n<extra_features>\nNumber of threaded faces: 1\n<Part::PartFeature>\n</extra_features>\n<var_cutting_para>\n{\n  \"material\": \"Aluminum\",\n  \"cutting_parameters\": {\n    \"operations\": {\n      \"Milling\": {\n        \"End Mill\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 75.0,\n              \"max\": 105.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.05,\n              \"max\": 0.15\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Prevent chip welding\"\n          },\n          \"Carbide\": {\n            \"cutting_speed_range\": {\n              \"min\": 150.0,\n              \"max\": 600.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.075,\n              \"max\": 0.25\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 5.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"High speed capable\"\n          }\n        },\n        \"Face Mill\": {\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 300.0,\n              \"max\": 1000.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.4\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 6.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Polished rake face\"\n          }\n        }\n      },\n      \"Turning\": {\n        \"External\": {\n          \"HSS\": {\n            \"cutting_speed_range\": {\n              \"min\": 60.0,\n              \"max\": 90.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.15,\n              \"max\": 0.35\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 4.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"Sharp cutting edges\"\n          },\n          \"Carbide Insert\": {\n            \"cutting_speed_range\": {\n              \"min\": 300.0,\n              \"max\": 800.0\n            },\n            \"feed_per_tooth_range\": {\n              \"min\": 0.2,\n              \"max\": 0.5\n            },\n            \"depth_of_cut_range\": {\n              \"min\": 1.0,\n              \"max\": 6.0\n            },\n            \"coolant_requirement\": \"Recommended\",\n            \"special_notes\": \"High polish tools\"\n          }\n        }\n      }\n    }\n  }\n}\n</var_cutting_para>\n<var_identified_faces>\nPart Analysis:\nVolume and Material Usage:\n- Part Volume: 8736.38 cubic units\n- Total Surface Area: 4995.31 square units\n- Raw Material Block Size (with 2mm margin):\n  * Length: 29.80 units\n  * Width: 44.00 units\n  * Height: 44.00 units\n- Raw Material Volume: 57695.51 cubic units\n- Material Removal Required: 48959.13 cubic units\n- Material Utilization: 15.1%\n\nFeature Summary:\nTotal Faces: 23\nBasic Surfaces:\n- 9 planar faces\n- 8 cylindrical faces\n- 2 conical faces\n- 0 spherical faces\n- 0 toroidal faces\n\nAdvanced Surfaces:\n- 0 Bezier surfaces\n- 4 B-Spline surfaces\n- 0 other surface types\n- 0 unidentified surfaces\n\nDetailed Surface Analysis:\nSurface 1:\n  Type: Cone\n  Area: 87.75\n  Radius: 19.48\n  Semi-Angle: 0.79\nSurface 2:\n  Type: Cone\n  Area: 87.75\n  Radius: 19.48\n  Semi-Angle: 0.79\nSurface 3:\n  Type: Cylinder\n  Area: 43.69\n  Radius: 2.50\nSurface 4:\n  Type: Cylinder\n  Area: 502.65\n  Radius: 20.00\nSurface 5:\n  Type: Cylinder\n  Area: 120.95\n  Radius: 7.00\nSurface 6:\n  Type: Cylinder\n  Area: 24.74\n  Radius: 7.00\nSurface 7:\n  Type: Cylinder\n  Area: 215.83\n  Radius: 12.50\nSurface 8:\n  Type: Cylinder\n  Area: 215.83\n  Radius: 12.50\nSurface 9:\n  Type: Plane\n  Area: 162.48\nSurface 10:\n  Type: Plane\n  Area: 162.48\nSurface 11:\n  Type: Plane\n  Area: 248.15\nSurface 12:\n  Type: Plane\n  Area: 153.94\nSurface 13:\n  Type: Plane\n  Area: 0.95\nSurface 14:\n  Type: BSpline\n  Area: 360.90\n  U Degree: 2\n  V Degree: 1\n  Control Points: 322\nSurface 15:\n  Type: BSpline\n  Area: 335.06\n  U Degree: 2\n  V Degree: 1\n  Control Points: 322\nSurface 16:\n  Type: Cylinder\n  Area: 73.68\n  Radius: 8.08\nSurface 17:\n  Type: Plane\n  Area: 770.45\nSurface 18:\n  Type: Plane\n  Area: 19.63\nSurface 19:\n  Type: Plane\n  Area: 0.24\nSurface 20:\n  Type: Cylinder\n  Area: 27.59\n  Radius: 3.04\nSurface 21:\n  Type: BSpline\n  Area: 102.55\n  U Degree: 2\n  V Degree: 1\n  Control Points: 322\nSurface 22:\n  Type: BSpline\n  Area: 107.10\n  U Degree: 2\n  V Degree: 1\n  Control Points: 322\nSurface 23:\n  Type: Plane\n  Area: 1170.93\n</var_identified_faces>\n<ideal_output>\n{\n  \"machining_analysis\": {\n    \"machining_process_selected\": \"Turn-Milling\",\n    \"setup_count\": 2,\n    \"tool_count\": 7,\n    \"operation_count\": 14,\n    \"machining_time\": 47.2 min,\n    \"toolpath_length\": 9440 mm,\n    \"process_details\": {\n      \"setup_1\": {\n        \"operations\": [\n          {\n            \"name\": \"Rough Turning\",\n            \"tool\": \"CNMG insert\",\n            \"length\": 2400 mm,\n            \"machining_time\": 12.5 min\n          },\n          {\n            \"name\": \"Semi-finish Turning\",\n            \"tool\": \"VNMG insert\",\n            \"length\": 1200 mm ,\n            \"machining_time\": 6.8 min\n          },\n          {\n            \"name\": \"Contouring\",\n            \"tool\": \"Ø12 End Mill\",\n            \"length\": 1800 mm,\n            \"machining_time\": 8.4 min\n          },\n          {\n            \"name\": \"Drilling\",\n            \"tool\": \"Ø7 Drill\",\n            \"length\": 240 mm,\n            \"machining_time\": 2.2 min\n          }\n        ],\n        \"total_toolpath_length\": 5640 mm,\n        \"total_machining_time\": 29.9 min\n      },\n      \"setup_2\": {\n        \"operations\": [\n          {\n            \"name\": \"Rough Turning\",\n            \"tool\": \"CNMG insert\",\n            \"length\": 1600 mm,\n            \"machining_time\": 8.6 min\n          },\n          {\n            \"name\": \"Finishing\",\n            \"tool\": \"VNMG insert\",\n            \"length\": 800 mm,\n            \"machining_time\": 4.2 min\n          },\n          {\n            \"name\": \"Threading operations\",\n            \"tool\": \"Threading tools\",\n            \"length\": 1400 mm,\n            \"machining_time\": 7.5 min\n          }\n        ],\n        \"total_toolpath_length\": 3800 mm,\n        \"total_machining_time\": 20.3 min\n      }\n    },\n    \"setup_times\": {\n      \"machine_setup\": 20 min,\n      \"tool_setup\": 15 min,\n      \"work_setup\": 15 min\n    }\n  },\n  \"justification\": {\n    \"machine_selection\": \"CNC Turn-Mill center selected due to complex geometry requiring both turning and milling\",\n    \"machine_size\": \"Stock size of 29.8 x 44 x 44 mm is suitable for standard turn-mill center\",\n    \"tool_selection\": [\n      \"CNMG insert for rough turning operations\",\n      \"VNMG insert for finish turning operations\",\n      \"End mills for contouring features\",\n      \"Drill bits for hole features\",\n      \"Threading tools for threads\"\n    ],\n    \"setup_considerations\": {\n      \"part_weight\": \"Aluminum material with moderate weight\",\n      \"reference_surfaces\": \"Multiple cylindrical features with varying diameters\",\n      \"alignment_requirements\": \"B-Spline surfaces require simultaneous axis control\",\n      \"fixturing_needs\": \"Standard for aluminum part\"\n    },\n    \"toolpath_notes\": \"High material removal rate (84.9%), cutting parameters based on aluminum machining recommendations, surface finish requirements, tool engagement considerations\"\n  },\n  \"material_removal_volume\": 48959.13 mm3, \n  \"calculations\": {\n    \"perimeter\": \"Complex geometry with 8 cylindrical faces ranging from Ø5mm to Ø40mm\",\n    \"radial_passes\": \"Multiple passes needed for 84.9% material removal\",\n    \"depth_passes\": \"Based on feature complexity including 4 B-Spline surfaces\"\n  }\n}\n</ideal_output>\n</example>\n</examples>\n\n"
                    },
                    {
                        "type": "text",
                        "text": prompt,
                    }
                ],
            }
        ]

    )
    return message.content




output = create_prompt(client=client,prompt=prompt,system_prompt=system_prompt)

print(output)

machining_analysis =  extract_json_from_text(str(output))
with open('machining_analysis.json', 'w') as json_file:
    json.dump(machining_analysis, json_file)